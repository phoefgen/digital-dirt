"use strict";function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function getData(t){fetch("http://localhost:1337/data.streetfoodapp.com/1.1/schedule/vancouver/").then(function(n){n.json().then(function(n){t(n)})})}function getTrucks(){getData(function(t){for(var n=Object.keys(t.vendors),e=n.length,i=[],o=0;o<e;o++){var r=t.vendors[n[o]];void 0!==t.vendors[n[o]].last&&i.push(r)}for(var s=0;s<i.length;s++)trucks.push(new truck(i[s],s));ko.applyBindings(new ViewModel)})}function initMap(){truckMap=new google.maps.Map(document.getElementById("map"),{zoom:13,center:{lat:49.246292,lng:-123.116226}}),getTrucks()}var _createClass=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),trucks=[],truckMap="",infowindow=void 0,truck=function(){function t(n,e){_classCallCheck(this,t),this.name=n.name,this.email=n.email,this.rating=n.rating,this.description_long=n.description,this.id=e,this.position={lat:n.last.latitude,lng:n.last.longitude},null!==n.description_short?this.description_short=n.description_short:this.description_short=" ",this.infowindowContent=this.createInfoWindowContent(),this.infowindow=new google.maps.InfoWindow({content:this.infowindowContent}),this.marker=this.createMarker(this.name,this.position,this.infowindow,this.id),this.visible=!0}return _createClass(t,[{key:"createMarker",value:function(t,n,e,i){var o=new google.maps.Marker({title:t,icon:"../img/truck.png",position:n,map:truckMap,animation:google.maps.Animation.DROP});return window.google.maps.event.addListener(o,"click",function(){trucks.forEach(function(t){t.infowindow.close(truckMap,t.marker)});var t=trucks[i];t.infowindow.open(truckMap,t.marker)}),o}},{key:"createInfoWindowContent",value:function(){return'<div id="truckDetail">\n                    <h1>'+this.name+"</h1>\n                    <h3>"+this.description_short+"</h3>\n                    <p>"+this.description_long+"</p>\n                    "}}]),t}(),ViewModel=function(){var t=this;t.trucks=ko.observableArray(trucks),t.selectedTruck=function(t){console.log(t),google.maps.event.trigger(t.marker,"click")},t.searchString=ko.observable(""),t.visibleTrucks=ko.computed(function(){return""===t.searchString()?t.trucks():ko.utils.arrayFilter(t.visibleTrucks(),function(n){t.searchString().toLowerCase();var e=n.name+n.description_short+n.description_long;return e.toLowerCase(e).contains(t.searchString())})})};